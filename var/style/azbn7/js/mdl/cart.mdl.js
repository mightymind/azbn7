!function(a){a.Azbn7&&!function(){var t=function(){var t=this;return t.name="cart",t.uid="azbn7__mdl__cart",t.data={cart:{},calculation:{sum:0,discount:0,to_pay:0,ids:0,variants:0},profile:{}},t.add=function(a,c,n,r,i){n=parseFloat(n)||1,r=parseFloat(r)||0,i=parseFloat(i)||0;var o=t.getItem(a,c);o?(o.qty=0+parseFloat(o.qty)+parseFloat(n),o.price=parseFloat(r)):o=t.createItem(a,c,n,r,i),t.setItem(o)},t.remove=function(a,c,n){n=parseFloat(n)||1;var r=t.getItem(a,c);r&&(r.qty=0+parseFloat(r.qty)-parseFloat(n),r.qty>0?t.setItem(r):(delete t.data.cart[r.id][r.variant],t.calculation()))},t.createItem=function(a,t,c,n,r){var i={id:a,variant:t,data:{},qty:parseFloat(c),price:parseFloat(n),discount:parseFloat(r)};return i},t.getItem=function(a,c){return t.data.cart[a]&&t.data.cart[a][c]?t.data.cart[a][c]:null},t.setItem=function(a){t.data.cart[a.id]||(t.data.cart[a.id]={}),t.data.cart[a.id][a.variant]=a,t.calculation()},t.calculation=function(){t.data.calculation.sum=0,t.data.calculation.ids=0,t.data.calculation.variants=0;for(var a in t.data.cart){var c=t.data.cart[a];t.data.calculation.ids++;for(var n in c){var r=c[n];t.data.calculation.variants++;var i=r.qty*r.price*((100-r.discount)/100);t.data.calculation.sum=t.data.calculation.sum+i}}t.data.calculation.to_pay=t.data.calculation.sum*((100-parseFloat(t.data.calculation.discount))/100),t.saveData()},t.createOrder=function(){},t.saveData=function(){a.Azbn7.ls.obj2s(t.uid,t.data)},t.loadData=function(){var c=a.Azbn7.ls.s2obj(t.uid);c&&(t.data=c)},t.clear=function(){t.data.cart={},t.calculation(),t.saveData()},t};a.Azbn7.load("Cart",new t),a.Azbn7.mdl("Cart").loadData()}()}(jQuery);